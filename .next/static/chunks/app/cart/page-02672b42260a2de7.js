(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{8865:function(e,t,r){Promise.resolve().then(r.bind(r,1354))},1354:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return CartPage}});var s=r(7437),a=r(2749),i=r(2265),n=r(4033);function CartPage(){let{data:e,status:t}=(0,a.useSession)(),r=(0,n.useRouter)(),[c,o]=(0,i.useState)([]),[l,d]=(0,i.useState)(!0),[u,h]=(0,i.useState)("");(0,i.useEffect)(()=>{if("loading"!==t){if(!e){r.push("/auth/signin");return}fetchCartItems()}},[e,t,r]);let fetchCartItems=async()=>{try{let e=await fetch("/api/cart");if(e.ok){let t=await e.json();o(t)}else h("Failed to fetch cart items")}catch(e){h("An error occurred while fetching cart items")}finally{d(!1)}},updateQuantity=async(e,t)=>{if(!(t<1))try{let r=await fetch("/api/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,quantity:t})});r.ok?fetchCartItems():h("Failed to update quantity")}catch(e){h("An error occurred while updating quantity")}},removeFromCart=async e=>{try{let t=await fetch("/api/cart",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e})});t.ok?fetchCartItems():h("Failed to remove item from cart")}catch(e){h("An error occurred while removing item")}};return"loading"===t||l?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-xl",children:"Loading..."})}):e?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Shopping Cart"}),u&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),0===c.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-gray-500 text-xl mb-4",children:"Your cart is empty"}),(0,s.jsx)("button",{onClick:()=>r.push("/"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Continue Shopping"})]}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,s.jsx)("div",{className:"p-6",children:c.map(e=>(0,s.jsxs)("div",{className:"flex items-center py-4 border-b border-gray-200 last:border-b-0",children:[(0,s.jsx)("img",{src:e.product.image,alt:e.product.name,className:"w-20 h-20 object-cover rounded-lg mr-4"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.product.name}),(0,s.jsxs)("p",{className:"text-gray-600",children:["$",e.product.price.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>updateQuantity(e.productId,e.quantity-1),className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition-colors",children:"-"}),(0,s.jsx)("span",{className:"w-12 text-center",children:e.quantity}),(0,s.jsx)("button",{onClick:()=>updateQuantity(e.productId,e.quantity+1),className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition-colors",children:"+"})]}),(0,s.jsxs)("div",{className:"ml-4 text-lg font-semibold text-gray-900",children:["$",(e.product.price*e.quantity).toFixed(2)]}),(0,s.jsx)("button",{onClick:()=>removeFromCart(e.productId),className:"ml-4 text-red-600 hover:text-red-800 transition-colors",children:"Remove"})]},e.id))}),(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 rounded-b-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"text-xl font-semibold text-gray-900",children:["Total: $",c.reduce((e,t)=>e+t.product.price*t.quantity,0).toFixed(2)]}),(0,s.jsxs)("div",{className:"space-x-4",children:[(0,s.jsx)("button",{onClick:()=>r.push("/"),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Continue Shopping"}),(0,s.jsx)("button",{onClick:()=>{alert("Checkout functionality coming soon!")},className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Proceed to Checkout"})]})]})})]})]})}):null}},4033:function(e,t,r){e.exports=r(94)}},function(e){e.O(0,[749,971,472,744],function(){return e(e.s=8865)}),_N_E=e.O()}]);