"use strict";(()=>{var r={};r.id=453,r.ids=[453],r.modules={72934:r=>{r.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:r=>{r.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:r=>{r.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:r=>{r.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:r=>{r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:r=>{r.exports=require("assert")},14300:r=>{r.exports=require("buffer")},6113:r=>{r.exports=require("crypto")},82361:r=>{r.exports=require("events")},57147:r=>{r.exports=require("fs")},13685:r=>{r.exports=require("http")},95687:r=>{r.exports=require("https")},41808:r=>{r.exports=require("net")},22037:r=>{r.exports=require("os")},71017:r=>{r.exports=require("path")},63477:r=>{r.exports=require("querystring")},12781:r=>{r.exports=require("stream")},24404:r=>{r.exports=require("tls")},57310:r=>{r.exports=require("url")},73837:r=>{r.exports=require("util")},59796:r=>{r.exports=require("zlib")},31333:(r,e,t)=>{t.r(e),t.d(e,{headerHooks:()=>x,originalPathname:()=>j,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>q});var s={};t.r(s),t.d(s,{DELETE:()=>DELETE,GET:()=>GET,POST:()=>POST,PUT:()=>PUT});var a=t(10884),o=t(16132),n=t(95798),i=t(94020),u=t(8192),c=t(69363);async function GET(){try{let r=await (0,i.getServerSession)(u.L);if(!r?.user?.email)return n.Z.json({error:"Unauthorized"},{status:401});let e=await (0,c.fq)(r.user.email);if(e.success)return n.Z.json(e.data);return n.Z.json({error:"Failed to fetch cart items"},{status:500})}catch(r){return console.error("Error fetching cart items:",r),n.Z.json({error:"Internal server error"},{status:500})}}async function POST(r){try{let e=await (0,i.getServerSession)(u.L);if(!e?.user?.email)return n.Z.json({error:"Unauthorized"},{status:401});let{productId:t,quantity:s=1}=await r.json();if(!t)return n.Z.json({error:"Product ID is required"},{status:400});let a=await (0,c.Xq)(e.user.email,parseInt(t),s);if(a.success)return n.Z.json({message:"Item added to cart"});return n.Z.json({error:"Failed to add item to cart"},{status:500})}catch(r){return console.error("Error adding to cart:",r),n.Z.json({error:"Internal server error"},{status:500})}}async function PUT(r){try{let e=await (0,i.getServerSession)(u.L);if(!e?.user?.email)return n.Z.json({error:"Unauthorized"},{status:401});let{productId:t,quantity:s}=await r.json();if(!t||s<1)return n.Z.json({error:"Invalid product ID or quantity"},{status:400});await (0,c.h2)(e.user.email,parseInt(t));let a=await (0,c.Xq)(e.user.email,parseInt(t),s);if(a.success)return n.Z.json({message:"Cart updated"});return n.Z.json({error:"Failed to update cart"},{status:500})}catch(r){return console.error("Error updating cart:",r),n.Z.json({error:"Internal server error"},{status:500})}}async function DELETE(r){try{let e=await (0,i.getServerSession)(u.L);if(!e?.user?.email)return n.Z.json({error:"Unauthorized"},{status:401});let{productId:t}=await r.json();if(!t)return n.Z.json({error:"Product ID is required"},{status:400});let s=await (0,c.h2)(e.user.email,parseInt(t));if(s.success)return n.Z.json({message:"Item removed from cart"});return n.Z.json({error:"Failed to remove item from cart"},{status:500})}catch(r){return console.error("Error removing from cart:",r),n.Z.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/cart/route",pathname:"/api/cart",filename:"route",bundlePath:"app/api/cart/route"},resolvedPagePath:"/Users/toobaasghar/Desktop/projects/daynnight/app/api/cart/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m,headerHooks:x,staticGenerationBailout:q}=p,j="/api/cart/route"}};var e=require("../../../webpack-runtime.js");e.C(r);var __webpack_exec__=r=>e(e.s=r),t=e.X(0,[657,938,798,564,20,363,192],()=>__webpack_exec__(31333));module.exports=t})();